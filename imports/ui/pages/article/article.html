<template name="listArticle">
    {{#if isInRoles 'cmsArticleList' }}
        <div class="container page page-matkul-page my-3">
            <label style="color: blue; margin: 0;">
                <a href="/articles/list">
                    Artikel
                </a>
                /
            </label>
            <div class="desktop-div">
                <div class="d-flex justify-content-between align-items-center">
                    <div class="title-page mt-3">
                        <h3>Artikel</h3>
                    </div>
                    <section class="section-page-shoulders">
                        <div class="btn-group" role="group" aria-label="command control">
                            {{#if isInRoles 'cmsArticleCreate, super-admin'}}
                                <a class="btn btn-primary" id="buat-artikel" href="/articles/create">
                                    <i class="fa fa-plus"></i><span>Buat Artikel</span>
                                </a>
                            {{/if}}
                            {{#if isInRoles 'superadmin'}}
                            <div class="dropdown">
                                <button class="btn btn-warning dropdown-toggle" type="button" id="adminMenu" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <i class="fa fa-gears"></i>
                                    Admin Menu
                                </button>
                                <div class="dropdown-menu" aria-labelledby="adminMenu">
                                        <button class="dropdown-item" id="repairDate">
                                            <i class="fa fa-wrench"></i> Repair Tanggal
                                        </button>
                                        <button class="dropdown-item" id="migratePartner">
                                            <i class="fa fa-exchange"></i> Migrasi Partner
                                        </button>
                                        <button class="dropdown-item" id="migrateHostName">
                                            <i class="fa fa-exchange"></i> Migrasi Hostname
                                        </button>
                                </div>
                            </div>
                            {{/if}}
                        </div>
                    </section>
                </div>
            </div>
            <div class="mobile-div">
                <div class="d-flex justify-content-between align-items-center">
                    <div class="title-page mt-3">
                        <h3>Artikel</h3>
                    </div>
                    <section class="section-page-shoulders">
                        <div class="dropdown">
                            <button class="btn btn-warning dropdown-toggle" type="button" id="adminMenu" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Menu
                            </button>
                            <div class="dropdown-menu" aria-labelledby="adminMenu" style="max-width: 200px;">
                                {{#if isInRoles 'cmsArticleCreate, super-admin'}}
                                    <a class="dropdown-item" id="buat-artikel" href="/articles/create">
                                        <i class="fa fa-plus"></i> Buat Artikel
                                    </a>
                                {{/if}}
                                <hr class="dropdown-divider">
                                {{#if isInRoles 'superadmin'}}
                                    <button class="dropdown-item" id="repairDate">
                                        <i class="fa fa-wrench"></i> Repair Tanggal
                                    </button>
                                    <button class="dropdown-item" id="migratePartner">
                                        <i class="fa fa-exchange"></i> Migrasi Partner
                                    </button>
                                    <button class="dropdown-item" id="migrateHostName">
                                        <i class="fa fa-exchange"></i> Migrasi Hostname
                                    </button>
                                {{/if}}
                            </div>
                        </div>
                    </section>
                </div>
            </div>
            <hr class="mt-4 mb-3" style="border: 1px solid lightgray;">
            <section class="section-matkul-list">
                {{#if problemList}}
                    {{#each problemList}}
                        <div>
                            {{this}}
                        </div>
                {{/each}}
                {{/if}}
                <h2 class="section-title my-3">Daftar Artikel</h2>
                <div class="table-responsive">
                    <table class="table table-bordered" style="margin-bottom: 1rem; margin-top:1rem;" id="mytable">
                        <thead>
                            <tr>
                                <th width="25%">Judul</th>
                                <th width="20%">Pembuat</th>
                                <th width="10%">Publikasi</th>
                                <th width="10%">Web Site</th>
                                <th width="25%">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each i in articles}}
                            <tr class="{{#if i.status}}{{else}}table-danger{{/if}}">
                                <td>{{ i.title }}</td>
                                <td>{{ i.author }}</td>
                                <td>{{ formatHRDate i.publishDate }}</td>
                                <td>{{ i.outlets }}</td>
                                <td>
                                    <div class="d-flex flex-wrap gap-1">
                                        {{#if isInRoles 'cmsArticleDelete'}}
                                        <a class="btn btn-primary btn-sm toggle-article" status="{{i.status}}" milik="{{toMeteorId i._id}}" value="{{i.status}}">
                                            {{#if i.status}}
                                                <i class="fa fa-eye text-white" status="{{i.status}}" milik="{{toMeteorId i._id}}" value="{{i.status}}"></i>
                                            {{else}}
                                                <i class="fa fa-eye-slash text-white" status="{{i.status}}" milik="{{toMeteorId i._id}}" value="{{i.status}}"></i>
                                            {{/if}}
                                        </a>
                                        {{/if}}
                                        {{#if i.status}}
                                            {{#if isInRoles 'cmsArticleFeatured'}}
                                                <a class="btn btn-primary btn-sm toggle-featured">
                                                    <i aria-hidden="true" id="{{ toMeteorId i._id}}"
                                                        class="fa fa-star {{#if i.featured}}text-orange{{else}}text-white{{/if}}"
                                                        status="{{i.featured}}" milik="{{ toMeteorId i._id}}" value="{{i.featured}}">
                                                    </i>
                                                </a>
                                            {{/if}}
                                            {{#if isInRoles 'cmsArticleEdit'}}
                                                <a class="btn btn-primary btn-sm btn-edit"
                                                    href="/articles/edit/{{toMeteorId i._id}}">
                                                    <i class="fa fa-edit" milik="{{toMeteorId i._id}}"></i>
                                                </a>
                                            {{/if}}

                                            {{#if isInRoles 'cmsArticleDelete'}}
                                                <button class="btn btn-danger btn-sm delete-article" id="{{toMeteorId i._id}}">
                                                    <i class="fa fa-trash delete-article" id="{{toMeteorId i._id}}"></i>
                                                </button>
                                            {{/if}}
                                        {{/if}}
                                        <div class="dropdown">
                                            <button class="btn btn-warning btn-sm dropdown-toggle" type="button" id="moreActionsDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                Aksi Lain
                                            </button>
                                            <div class="dropdown-menu" aria-labelledby="moreActionsDropdown">
                                                {{#if isInRoles 'vecumFest'}}
                                                    <a class="dropdown-item" href="#" id="openModalBtn" data-milik="{{i.slug}}">Lihat QR</a>
                                                {{/if}}
                                                <a class="dropdown-item" href="/articles/evaluation/{{toMeteorId i._id}}">Evaluasi</a>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            {{/each}}
                        </tbody>
                    </table>
                </div>
            </section>
            <div id="myModal" class="modal">
                <!-- <div class="modal-dialog modal-dialog-scrollable"> -->
                    <div class="modal-content">
                        <span class="close">&times;</span>
                        <h2 class="text-center">Detail QR</h2>
                        <div class="w-75 mx-auto">
                            <div class="boarding-pass" id="boarding-pass" style="border: 1px solid black">
                                <div class="canvas-wrapper">
                                    <canvas id="canvas"></canvas>
                                </div>
                            </div>
                        </div>
                        <table class="table summary-table">
                            <tbody>
                                <tr>
                                    <th width="100">Nama</th>
                                    <th width="10">:</th>
                                    <th id="fullName"></th>
                                </tr>
                            </tbody>
                        </table>
                        <button class="btn btn-primary" id="download">Unduh</button>
                    </div>
                <!-- </div> -->
            </div>
        </div>
    {{ else }}
        {{> notAuthorized }}
    {{/ if}}
    <style>
        .canvas-wrapper {
            width: 95%;
            height: 95%;
            max-width: 100%;
            max-height: 100%;
            overflow: hidden;
        }
        .modal-content {
            height: 100vh;
            overflow-y: auto;
        }

        .text-orange {
            color: orange;
        }

        .mobile-div{
            display: none;
        }

        .desktop-div{
            display: block;
        }

        @media (max-width: 1040px) {
            .desktop-div {
                display: none;
            }
            .mobile-div {
                display: block;
            }
        }

        @media only screen and (max-width: 600px) {
            .desktop-div {
                display: none;
            }
            .mobile-div {
                display: block;
            }

        }
    </style>

</template>

<template name="createArticle">
    {{#if isInRoles 'cmsArticleCreate, superadmin, admin' }}
        <div class="container mt-3">
            <label style="color: blue; margin: 0;">
                <a href="/articles/list" class="text-secondary">
                    Artikel
                </a>
                /
                <a href="/articles/create">
                    Tambah
                </a>
            </label>
            <div class="title-page mt-3">
                <h3>Tambah Artikel</h3>
            </div>
            <hr class="my-3" style="border: 1px solid lightgray;">
            {{> formArticle submitType=1}}
        </div>
    {{ else }}
        {{> notAuthorized }}
    {{/ if}}
</template>

<template name="editArticle">
    {{#if isInRoles 'cmsArticleEdit' }}
        <div class="container page">
            <label style="color: blue; margin: 0;">
                <a href="/articles/list" class="text-secondary">
                    Artikel
                </a>
                /
                <!-- Belum diganti url nya -->
                <a href="/articles/edit/{{_id}}">
                    Ubah
                </a>
            </label>
            <div class="title-page mt-3">
                <h3>Ubah Artikel</h3>
            </div>
            <hr class="my-3" style="border: 1px solid lightgray;">
            {{>formArticle submitType=2}}
        </div>
    {{ else }}
        {{> notAuthorized }}
    {{/ if}}
</template>

<template name="formArticle">
    <section class="my-3">
        <div class="row row-cols-1 row-cols-md-2">
            <div class="col form-group">
                <label for="" class="text-left fw-bold">Judul</label>
                <input type="text" id="title" class="form-control">
            </div>
            <div class="col form-group">
                <label for="" class="text-left fw-bold">Slug</label>
                <input type="text" id="slug" class="form-control">
            </div>
        </div>
        <div class="row row-cols-1 row-cols-md-2">
            <div class="col form-group">
                <label for="" class="text-left fw-bold">Author</label>
                <input type="text" id="author" class="form-control">
            </div>
            <div class="col form-group">
                <label for="" class="text-left fw-bold">Penjelasan Singkat</label>
                <input type="text" id="excerpt" class="form-control">
            </div>
        </div>
        {{#if greaterThan partners.length 0 }}
            <div class="form-group">
                <label class="fw-bold">Pilih Partner</label>
                <select name="select-partner" id="select-partner" class="select2 form-control select-evaluator">
                    <option value="0">-- Pilih Partner --</option>
                    {{#each partners}}
                    <option value="{{code}}">{{name}}</option>
                    {{/each}}
                </select>
                <ul class="list-group">
                    {{#if selectedPartner }}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <span class="name">{{ selectedPartner.name }}</span>
                    </li>
                    {{/if}}
                </ul>
            </div>
        {{/if}}
        {{#if isInRoles 'superadmin'}}
            {{#if outlets}}
                <div class="form-group">
                    <label class="text-left fw-bold">Outlet</label>
                    <div class="row row-cols-1 row-cols-md-5">
                        {{#each outlets}}
                            <div class="col">
                                <div class="form-check">
                                    <input type="checkbox" name="" class="form-check-input outlet" style="margin-left: -1.25rem; margin-top: 0.3rem;" id="outlet-{{code}}" value="{{code}}">
                                    <label for="outlet-{{code}}" class="form-check-label">{{name}} - {{code}}</label>
                                </div>
                            </div>
                        {{/each}}
                    </div>
                </div>
            {{/if}}
        {{/if}}
        {{#if categories}}
        <div class="form-group">
            <label class="text-left fw-bold">Kategori</label>

            <select class="select2 form-control" id="category">
                <option>Pilih Kategori</option>
                {{#each item in categories}}
                    <option value="{{item.name}}">{{item.name}}</option>
                {{/each}}
            </select>
        </div>
        {{/if}}
        <div class="form-group">
            <label class="fw-bold">Tanggal Publish</label>
            <input type="date" name="" class="form-control" id="publish-date">
        </div>
        <label class="fw-bold">Isi</label>
        <!-- The toolbar will be rendered in this container. -->
        <div id="toolbar-container"></div>

        <!-- This container will become the editable. -->
        <div id="editor" class="ckeditor-content mb-3">
        </div>
        {{> inputSingleFile name="logo" label="Thumbnail Artikel" imageFile=logo }}
        <!-- <div class="form-group">

            <label for="">Gambar Artikel</label><br>
            <img id="paymentImage" src="#" alt="your image" width="300" height="300" /><br>
            <input type="file" id="paymentFile" name="filename" accept="image/gif, image/jpeg, image/png" multiple>
        </div> -->
        <hr class="mt-2 mb-3" style="border: 1px solid lightgray;">
        <div class="form-group d-flex justify-content-end mt-3">
            <button class="btn btn-primary" id="submit-form">Post</button>
        </div>
    </section>

    <style>
        .list-group-item {
            padding: 2rem 1rem;
        }
        .form-check-input {
            position: absolute;
            margin-top: 0.3rem;
            margin-left: -1.25rem;
        }
        .form-check-input:disabled ~ .form-check-label {
            color: #999;
        }
        #editor{
            border: 1px solid black;
        }
    </style>
</template>

<template name="detailArticle">

</template>

<template name="inputSingleFile">
    <div class="form-group inputNameUploadFiles">
      <label class="fw-bold">{{ label }}</label>
      <div>
        <label for="{{ name }}File" class="btn btn-primary">Unggah Foto/File</label>
      </div>
      <input class="hidden input-file input-{{ name }}File" name="{{ name }}File" id="{{ name }}File" type="file">
      <div class="uploaded-image mt-2">
        <a id="{{ name }}Link" class="" target="_blank" rel="noreferrer" >
          <img id="{{ name }}Image" alt="{{ imageFile.name }}" class="thumbnail" style="max-width: 250px;">
        </a>
      </div>
    </div>
</template>

