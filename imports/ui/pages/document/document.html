
<template name="list_document">
    <div class="container">
        {{#if isInRole "sekretaris-keuskupan, sekretariat, arsip, admin, super-admin"}}
            <div class="d-flex justify-content-end mb-2">
                <a href="/documents/create" class="btn btn-primary">+Tambah</a>
            </div>
            <h3>Daftar Surat Masuk</h3>
            <div class="input-group mb-3">
                <div class="form-group">
                    <label for="documentName">Nama Surat</label>
                    <input type="text" class="form-control search-input" id="documentName" placeholder="Nama Surat">
                </div>
                <div class="form-group ml-3">
                    <label for="documentSource">Asal Surat</label>
                    <input type="text" class="form-control search-input" id="documentSource" placeholder="Asal Surat">
                </div>
                <div class="form-group ml-3 d-flex">
                    <div class="mr-3">
                        <label for="documentDate">Tanggal Surat Masuk Mulai</label>
                        <input type="date" class="form-control search-input" id="startDate" max={{startDate}} placeholder="Tanggal Surat Masuk">
                    </div>
                    <div>
                        <label for="endDate">Tanggal Surat Masuk Sampai</label>
                        <input type="date" class="form-control search-input" id="endDate" min={{endDate}} placeholder="Masa Berakhir">
                    </div>
                </div>
                <div class="form-group ml-3" style="margin-top:32px; padding-left: 10px;">
                    <button class="btn btn-primary" type="button" id="btn-search">
                        <i class="fas fa-search" id="btn-search"></i> Cari
                    </button>
                    <button id="btn-refresh" class="btn btn-primary">
                        <i class="fas fa-sync-alt" id="btn-refresh"></i> Refresh
                    </button>
                </div>
            </div>
            <div class="d-lg-block table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th scope="col">No</th>
                            <th scope="col">Nama</th>
                            <th scope="col">Sumber</th>
                            <th scope="col">Tanggal</th>
                            <th scope="col">Berkas</th>
                            <th scope="col">Aksi</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{#each dataDocument}}
                        <tr>
                            <td> {{nomorUrut @index}} </td>
                            <td style="text-transform: capitalize;"> {{name}} </td>
                            <td style="text-transform: capitalize;"> {{source}} </td>
                            <td> {{formatHRDate date}} </td>
                            {{#if link}}
                            <td>
                                <a href="https://drive.google.com/viewerng/viewer?url={{link}}" target="_blank" class="pdf-link">
                                <i class="fas fa-file-pdf"></i>
                                </a>
                            </td>
                            {{else}}
                            <td><i class="fas fa-file-pdf"></i></td>
                            {{/if}}
                            <td>
                                <a href="/documents/details/{{_id}}">
                                    <button class="btn btn-primary" type="button" id="btn_details">Detail</button>
                                </a>
                            </td>
                        </tr>
                        {{/each}}
                    </tbody>
                </table>
            </div>
        {{/if}}
    </div>
</template>

<template name="create_document">
    <div class="container">
        <div class="title-page">
            <h3> Tambah Surat Masuk </h3>
        </div>
        <form>
            <div class="form-group mb-2">
                <label>Nama Surat</label>
                <input type="text" id="input_fullName" class="form-control" required />
            </div>
            <div class="form-group mb-2">
                <label>Asal Surat</label>
                <input type="text" id="input_sumber" class="form-control" required>
            </div>
            <div class="form-group mb-2">
                <label>Tanggal</label>
                <input type="date" id="input_tanggal" class="form-control" />
            </div>
            <div class="form-group mb-2">
                <label>Jenis Surat</label>
                <select id="input_jenisDokumen" class="form-control">
                    <option value="Surat Keputusan">Surat Keputusan</option>
                    <option value="Surat Rahasia">Surat Rahasia</option>
                    <option value="Surat Biasa">Surat Biasa</option>
                </select>
            </div>
            <br>
            <div class="form-group mb-2">
                <input type="file" name="filePDF" id="filePDF" accept=".pdf" required>
            </div>
            <!-- <button type="button" class="btn btn-primary" onclick="previewPDF()">Preview</button> -->
            <br><br>
            <div class="d-grid gap-2">
                <button class="btn btn-primary" type="submit" id="btn_save">Simpan</button>
            </div>
        </form>
        <!-- contoh iframe untuk preview pdf -->
        <!-- <iframe style="width: 300px; height: 300px;" src="https://docs.google.com/viewer?url=https://cdn.imavi.org/219116841-Stlh%20Perbaikan.pdf&embedded=true"></iframe> -->
    </div>
</template>

<template name="detailDocument">
    <div class="container">
        <div class="title-page">
            <h3> Detail Surat Masuk </h3>
        </div>
        <form>
            <div class="form-group mb-2">
                <label>Nama Dokumen</label>
                <input type="text" id="input_fullName" class="form-control" value="{{dataDokumen.name}}">
            </div>
            <div class="form-group mb-2">
                <label>Asal Dokumen</label>
                <input type="text" id="input_sumber" class="form-control" value="{{dataDokumen.source}}">
            </div>
            <div class="form-group mb-2">
                <label>Tanggal</label>
                <input type="date" id="input_tanggal" class="form-control" value="{{dateToHTML dataDokumen.date}}">
            </div>
            <div class="form-group mb-2">
                <label>Jenis Dokumen</label>
                <select id="input_jenisDokumen" class="form-control">
                    {{#if equals dataDokumen.documentType "Surat Penting"}}
                    <option value="Surat Penting" selected>Surat Penting</option>
                    {{else}}
                    <option value="Surat Penting">Surat Penting</option>
                    {{/if}}
                    {{#if equals dataDokumen.documentType "Surat Rahasia"}}
                    <option value="Surat Rahasia" selected>Surat Rahasia</option>
                    {{else}}
                    <option value="Surat Rahasia">Surat Rahasia</option>
                    {{/if}}
                    {{#if equals dataDokumen.documentType "Surat Biasa"}}
                    <option value="Surat Biasa" selected>Surat Biasa</option>
                    {{else}}
                    <option value="Surat Biasa">Surat Biasa</option>
                    {{/if}}
                </select>
            </div>
            <br>
            <div class="form-group mb-2">
                <input type="file" name="filePDF" id="filePDF" accept=".pdf" required>
            </div>
            {{#if dataDokumen.link}}
             <h3>Bila preview tidak tampil, silahkan reload halaman ini</h3>
                <iframe id="previewDoc" style="width: 100%; height: 300px;"
                src="https://docs.google.com/viewer?url={{dataDokumen.link}}&embedded=true"></iframe>
             {{/if}}
            <br>
            <div class="form-actions">
                <button class="btn btn-primary" id="submit">Simpan</button>
            </div>
        </form>
    </div>
</template>

<template name="reviewDocument">
    <div class="container">
        {{> detailDocument}}
        <div class="title-page">
            <h3> Review Dokumen </h3>
        </div>
        <form>
            <!-- <iframe style="width: 100%; height: 300px;" src="https://docs.google.com/viewer?url={{dataDocument.linkPDF}}&embedded=true"></iframe> -->
            <div class="form-group mb-2">
                <label>Review</label><br>
                <textarea id="input_review" style="width: 100%;" rows="3"></textarea>
            </div>
            <!-- <div class="d-grid gap-2">
                <button class="btn btn-primary" type="submit" id="btn_save">Simpan</button>
            </div> -->
            <div class="d-flex justify-content-end mb-2">
                <button class="btn btn-danger mx-2" type="submit" id="btn_tolak">Tolak</button>
                <button class="btn btn-success" type="submit" id="btn_setuju">Setuju</button>
            </div>
        </form>
    </div>
</template>



<!-- Start Korespondensi -->
<template name="listKorespondensi" id ="listKorespondensi">
    <div class="container">
        <div class="section-label-page">
            <h3>Surat Keluar</h3>
        </div>
        <div class="section-action-page">
            <a href="/createKorespondensi" class="btn btn-primary">+ Buat Surat Baru</a>
        </div>
        <br><br>
        {{#if isInRole "sekretaris-keuskupan, sekretariat, arsip, admin, super-admin"}}
            <ul class="nav nav-tabs">
                <li class="nav-item">
                    <a class="nav-link active" data-toggle="tab" href="#all">Daftar Semua Surat</a>
                </li>
            
            </ul>
            <div class="tab-content">
                <div id="all" class="tab-pane fade show active">
                    <h3>Daftar Semua Surat</h3>
                    <div class="input-group mb-3">
                        <div class="form-group">
                            <label for="nameOfNumber">Nomor Surat</label>
                            <input type="text" class="form-control search-input" id="nameOfNumber" placeholder="Perihal">
                        </div>
                        <div class="form-group ml-3">
                            <label for="nameOfPerihal">Perihal</label>
                            <input type="text" class="form-control search-input" id="nameOfPerihal" placeholder="Perihal">
                        </div>
                        <div class="form-group ml-3">
                            <label for="nameOfPenerima">Penerima</label>
                            <input type="text" class="form-control search-input" id="nameOfPenerima" placeholder="Penerima">
                        </div>
                        <div class="form-group ml-3 d-flex">
                            <div class="mr-3">
                                <label for="documentDate">Tanggal SK Berakhir Mulai</label>
                                <input type="date" class="form-control search-input" id="startDate" max={{startDate}} placeholder="Tanggal Surat Masuk">
                            </div>
                            <div>
                                <label for="endDate">Tanggal SK Berakhir Sampai</label>
                                <input type="date" class="form-control search-input" id="endDate" min={{endDate}} placeholder="Masa Berakhir">
                            </div>
                        </div>
                        <!-- <div class="form-group ml-3" style="margin-top:32px; padding-left: 10px;">
                            <button class="btn btn-primary" type="button" id="btn-search">
                                <i class="fas fa-search" id="btn-search"></i> Cari
                            </button>
                            <button id="btn-refresh" class="btn btn-primary">
                                <i class="fas fa-sync-alt" id="btn-refresh"></i> Refresh
                            </button>
                        </div> -->
                    </div>
                    <div class="text-center">
                        <button class="btn btn-primary" type="button" id="btn-search">
                            <i class="fas fa-search" id="btn-search"></i> Cari
                        </button>
                        <button id="btn-refresh" class="btn btn-primary">
                            <i class="fas fa-sync-alt" id="btn-refresh"></i> Refresh
                        </button>
                    </div>
                    <br>
                    
                    <div class="section-content-page">
                        <table class="table table-bordered">
                            <thead>
                                <th>No</th>
                                <th>No. Surat Keluar</th>
                                <th>Kategori Surat</th>
                                <th>Perihal Surat</th>
                                <th>Penerima Surat</th>
                                <th>Tanggal Dibuat</th>
                                <th>Masa Berakhir</th>
                                <th>Pembuat</th>
                                <th>Berkas</th>
                                <th>Aksi</th>
                            </thead>
                            <tbody>
                                {{#each dataKorespondensi}}
                                <tr>
                                  <td>{{setTableNumber @index}}</td>
                                  <td>{{documentNumber}}</td>
                                  <td>{{categoryName}}</td>
                                  <td>{{about}}</td>
                                  <td>{{receiver}}</td>
                                  <td>{{formatHRDate createdAt}}</td>
                                  <td>
                                    {{#if tanggalBerakhir}}
                                        {{formatHRDate tanggalBerakhir}}
                                    {{else}}
                                        -
                                    {{/if}}
                                  </td>
                                  <td>{{capitalizeWord createdByName}}</td>
                                  <td>
                                    {{#if linksLetter}}
                                        <a href="https://drive.google.com/viewerng/viewer?url={{linksLetter.link}}" target="_blank" class="pdf-link">
                                            <i class="fas fa-file-word"></i>
                                        </a>
                                    {{else}}
                                        <i class="fas fa-file-word"></i>
                                    {{/if}}
                                    {{#if linksLetterSignatured}}
                                        <a href="https://drive.google.com/viewerng/viewer?url={{linksLetterSignatured.link}}" target="_blank" class="pdf-link">
                                            <i class="fas fa-file-pdf" style="margin-left: 10px;"></i>
                                        </a>
                                    {{else}}
                                        <i class="fas fa-file-pdf" style="margin-left: 10px;"></i>
                                    {{/if}}
                                  </td>
                                  <td>
                                    <a href="/detailKorespondensi/{{_id}}">
                                      <button class="btn btn-primary" type="button" id="btn_details">Detail</button>
                                    </a>
                                  </td>
                                </tr>
                                {{/each}}
                              </tbody>
                              
                        </table>
                    </div>
                </div>
            </div>
        {{/if}}
    </div>
    
</template>

<template name="createKorespondensi">
    <div class="container">
        <div class="section-title-page">
            <h3>Buat Surat Keluar</h3>
        </div>
        <div class="section-content-page">
            <div class="page">
                <div class="form-group">
                    <label for="">Kategori Surat</label>
                    <select id="category" class="form-control ">
                        <option>Pilih Kategori</option>
                        {{#each categoryLetters}}
                        <option value="{{_id}}" milik="{{slug}}">{{ name }}</option>
                        {{/each}}
                    </select>
                </div>
                <div class="form-group-container" style="display: flex; justify-content: space-between; gap: 15px;">
                    <div class="form-group" style="flex: 1; min-width: 0;">
                        <label for="field1">Nomor Urut Surat</label>
                        <input type="text" id="field1" class="form-control" placeholder="Nomor Urut" value={{nomorSurat.number}} disabled>
                    </div>
                    <div class="form-group" style="flex: 1; min-width: 0;">
                        <label for="field2">Kode Surat</label>
                        <input type="text" id="code" class="form-control" placeholder="Kode">
                    </div>
                    <div class="form-group" style="flex: 1; min-width: 0;">
                        <label for="field3">Bulan</label>
                        <input type="text" id="bulan" class="form-control" placeholder="Bulan" value={{nomorSurat.currentMonth}} disabled>
                    </div>
                    <div class="form-group">
                        <label for="field4">Tahun</label>
                        <input type="text" id="tahun" class="form-control" placeholder="Tahun" value={{nomorSurat.currentYear}} disabled>
                    </div>
                </div>
                {{#if equals isSKLetter true}}
                    <div class="form-group">
                        <label>Tanggal Berlaku</label>
                        <input type="date" class="form-control" id="date-start" />
                    </div>
                    <div class="form-group">
                        <label>Tanggal Berakhir</label>
                        <input type="date" class="form-control" id="date-end" />
                    </div>
                {{/if}}
                <div class="form-group">
                    <label for="">Penerima</label>
                    <input type="text" id="receiver" class="form-control">
                </div>
                <div class="form-group">
                    <label for="">Perihal</label>
                    <input type="text" id="about" class="form-control">
                </div>
                <div class="form-actions">
                    <button class="btn btn-primary" id="submit">Simpan</button>
                </div>
            </div>
        </div>
    </div>
</template>

<template name="editKorespondensi">
    <div class="container">
        <div class="section-title-page">
            <h3>Ubah Surat</h3>
        </div>
        <div class="section-content-page">
            <div class="page">
                <div class="form-group">
                    <label for="">Kategori Surat</label>
                    <select id="category" class="form-control ">
                        <option>Pilih Kategori</option>
                        {{#each categoryLetters}}
                            {{#if equals dataKorespondensi.category _id}}
                                <option value="{{_id}}" milik="{{slug}}" selected>{{ name }}</option>
                            {{else}}
                                <option value="{{_id}}" milik="{{slug}}">{{ name }}</option>
                            {{/if}}
                        {{/each}}
                    </select>
                </div>
                {{#if equals isSKLetter true}}
                    <div class="form-group">
                        <label>Tanggal Berlaku</label>
                        <input type="date" class="form-control" id="date-start" value="{{dateToHTML dataKorespondensi.tanggalBerlaku}}"/>
                    </div>
                    <div class="form-group">
                        <label>Tanggal Berakhir</label>
                        <input type="date" class="form-control" id="date-end" value="{{dateToHTML dataKorespondensi.tanggalBerakhir}}"/>
                    </div>
                {{/if}}
                <!-- <div class="form-group">
                    <label for="">Nama Surat</label>
                    <input type="text" id="nameOfLetter" class="form-control" value="{{dataKorespondensi.name}}">
                </div> -->
                <div class="form-group">
                    <label for="">Catatan Surat</label>
                    <input type="text" id="noteOfLetter" class="form-control" value="{{dataKorespondensi.note}}">
                </div>
                <div class="form-group">
                    <label for="">Penerima</label>
                    <input type="text" id="toLetter" class="form-control" value="{{dataKorespondensi.purpose}}">
                </div>


                <div class="form-group">
                    <label for="">Lampiran</label>
                    <input type="text" id="attach" class="form-control" value="{{dataKorespondensi.attachment}}">
                </div>
                <div class="form-group">
                    <label for="">Perihal</label>
                    <input type="text" id="about" class="form-control" value="{{dataKorespondensi.subject}}">
                </div>


                <div class="form-group">
                    <label for="">Isi surat</label>
                    <div id="toolbar-containerDescription"></div>
					<div id="editorDescription" class="toolbar-containerDescription"
						style="background-color: white;color: black;">
					</div>
                </div>

                

                {{#if equals jabatanLogin "sekretaris-keuskupan"}}
                    <div class="form-group">
                        <label>Alur</label>
                    
                        <select id="input_alur" class="form-control select2" multiple>
                            <option value="sekretaris-eksekutif">Sekretaris Eksekutif</option>
                            <option value="bidang">Bidang</option>
                            <option value="sekretaris-yayasan">Sekretaris Yayasan</option>
                            <option value="dewan-pengurus">Dewan Pengurus</option>
                            <option value="pengurus-inti">Pengurus Inti</option>
                            <option value="administrasi-umum">Administrasi Umum</option>
                        </select>
                        <br><br>
                        <button class="btn btn-primary" id="btn-add-alur">Tambah</button>
                    </div>
              
                    {{#if daftarAlur}}
                        <h4>Daftar Alur</h4>
                        <div class="table-responsive">
                            <table class="table table-bordered">
                                <thead>
                                    <th>Nomor</th>
                                    <th>Jabatan</th>
                                    <th>Aksi</th>
                                </thead>
                                <tbody>
                                    {{#each i in daftarAlur}}
                                    <tr>
                                        <td>
                                            {{setTableNumber @index}}
                                        </td>
                                        <td>
                                            {{setJabatanFormat i}}
                                        </td>
                                        <td>
                                            <button class="btn btn-danger btn-remove" posisi={{@index}}>
                                                <i class="fa fa-trash" posisi={{@index}}></i>
                                            </button>
                                        </td>
                                    </tr>
                                    {{/each}}
                                </tbody>
                            </table>
                        </div>
                    {{/if}}

                    <h4>Yang Bertandatangan</h4>
                    <button class="btn btn-primary" id="btn-add-signer">Tambah</button>
                    <div class="form-group">
                        <input type="checkbox" id="sameWithMaker" name="sameWithMaker">
                        <label for="sameWithMaker">Sama dengan yang login</label><br>
                    </div> 
                    <div class="form-group">
                        <input type="checkbox" id="letterMaker" name="letterMaker">
                        <label for="letterMaker">Pembuat Surat</label><br>
                    </div>
                    <div class="form-group">
                        <label for="nameSignotory">Nama</label>
                        <input type="text" id="nameSignotory" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="positionSignotory">Posisi</label>
                        <input type="text" id="positionSignotory" class="form-control">
                    </div>
             
    
                    {{#if listKorespondensiSigner}}
                    <h4>Yang Bertandatangan</h4>
                    <div class="table-responsive">
                        <table class="table table-bordered">
                            <thead>
                                <th>No</th>
                                <th>Nama</th>
                                <th>Posisi</th>
                                <th>Aksi</th>
                            </thead>
                            <tbody>
                                {{#each item in listKorespondensiSigner}}
                                <tr>
                                    <td>
                                        {{setTableNumber @index}}
                                    </td>
                                    <td>
                                        {{item.nameSignotory}}
                                    </td>
                                    <td>
                                        {{setJabatanFormat item.positionSignotory}}
                                    </td>
                                    <td>
                                        <button class="btn btn-danger btn-remove-signer" posisi={{@index}}>
                                            <i class="fa fa-trash" posisi={{@index}}></i>
                                        </button>
                                    </td>
                                </tr>
                                {{/each}}
                            </tbody>
                        </table>
                    </div>
                    {{/if}}


                    <h4>Tembusan</h4>
                    <button class="btn btn-primary" id="btn-add-tembusan">Tambah</button>
                 
                    <div class="form-group">
                        <label for="tembusanName">Nama</label>
                        <input type="text" id="tembusanName" class="form-control">
                    </div>
           
    
                    {{#if listTembusan}}
                    <h4>Daftar Tembusan</h4>
                    <div class="table-responsive">
                        <table class="table table-bordered">
                            <thead>
                                <th>No</th>
                                <th>Nama Tembusan</th>
                                <th>Aksi</th>
                            </thead>
                            <tbody>
                                {{#each i in listTembusan}}
                                <tr>
                                    <td>
                                        {{setTableNumber @index}}
                                    </td>
                                    <td>
                                        {{i.tembusanName}}
                                    </td>
                                    
                                    <td>
                                        <button class="btn btn-danger btn-remove-tembusan" posisi={{@index}}>
                                            <i class="fa fa-trash" posisi={{@index}}></i>
                                        </button>
                                    </td>
                                </tr>
                                {{/each}}
                            </tbody>
                        </table>
                    </div>
                    {{/if}}
                {{/if}}

                <div class="form-actions">
                    <button class="btn btn-primary" id="submit">Simpan Draft</button>
                    <button class="btn btn-success" id="btn-send">Ajukan</button>
                </div>
                <!-- Modal Konfirmasi -->
                <div class="modal fade" id="confirmDeleteModal" tabindex="-1" role="dialog" aria-labelledby="confirmDeleteModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="confirmDeleteModalLabel">Konfirmasi Hapus</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        Apakah Anda yakin ingin menghapus data ini?
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Batal</button>
                        <button type="button" class="btn btn-danger" id="confirmDeleteButton">Hapus</button>
                    </div>
                    </div>
                </div>
                </div>


            </div>
        </div>
    </div>
</template>

<template name="detailKorespondensi">
    <div class="container">
        <div class="section-title-page">
            <h3>Surat Keluar</h3>
        </div>
        <div class="section-content-page">
            <div class="page">
                <div class="form-group">
                    <label for="">Nomor Surat</label>
                    <input type="text" id="documentNumber" class="form-control" value="{{letterData.documentNumber}}" disabled>
                </div>
                <div class="form-group">
                    <label for="">Kategori Surat</label>
                    <select id="category" class="form-control " disabled>
                        <option>Pilih Kategori</option>
                        {{#each categoryLetters}}
                            {{#if equals letterData.categoryId _id}}
                                <option value="{{_id}}" milik="{{slug}}" selected>{{ name }}</option>
                            {{else}}
                                <option value="{{_id}}" milik="{{slug}}">{{ name }}</option>
                            {{/if}}
                        {{/each}}
                    </select>
                </div>
                {{#if equals isSKLetter true}}
                    <div class="form-group">
                        <label>Tanggal Berlaku</label>
                        <input type="date" class="form-control" id="date-start" disabled value="{{dateToHTML letterData.tanggalBerlaku}}"/>
                    </div>
                    <div class="form-group">
                        <label>Tanggal Berakhir</label>
                        <input type="date" class="form-control" id="date-end" disabled value="{{dateToHTML letterData.tanggalBerakhir}}"/>
                    </div>
                {{/if}}
                <div class="form-group">
                    <label for="">Penerima</label>
                    <input type="text" id="receiver" class="form-control" value="{{letterData.receiver}}">
                </div>
                <div class="form-group">
                    <label for="">Perihal</label>
                    <input type="text" id="about" class="form-control" value="{{letterData.about}}">
                </div>

                {{> inputMultipleFilesSurat label="Pilih File Surat" id="buktiSurat" files=buktiSurat buttonLabel="Upload"}}

                {{#if letterData.linksLetter}}
                    <h3>Bila preview surat tidak tampil, silahkan reload halaman ini</h3>
                    {{#each letterData.linksLetter}}
                        <iframe src="https://docs.google.com/gview?url={{link}}&embedded=true" width="100%" height="500" style="border: none;"></iframe>
                    {{/each}}
                {{/if}}

                <br><br>

                {{> inputMultipleFilesSurat label="Pilih File Surat Tanda Tangan" id="buktiSuratTTD" files=buktiSuratTTD buttonLabel="Upload"}}
                
                {{#if letterData.linksLetterSignatured}}
                    <h3>Bila preview tidak tampil, silahkan reload halaman ini</h3>
                    {{#each letterData.linksLetterSignatured}}
                        <iframe src="https://docs.google.com/gview?url={{link}}&embedded=true" width="100%" height="500" style="border: none;"></iframe>
                    {{/each}}
                {{/if}}
                <div class="form-actions">
                    <button class="btn btn-primary" id="submit">Simpan</button>
                </div>
            </div>
        </div>
    </div>
    <br>
    {{ >timelineWorkProgram timelines=letterData.timeline }}
</template>

<template name="letterKopTemplate">
    <!-- <table width="100%">
        <tr>
            <td>
                <img src="/img/headersuratimavi.png" width="50%" alt="kop-surat">
            </td>
        </tr>
    </table> -->

    <div class="d-flex justify-content-between">
        <div class="d-flex flex-column">
            <span>GEREJA KATOLIK</span>
            <span>KEUSKUPAN SURABAYA</span>
            <span>Jl. PolisiIstimewa 17, Surabaya 60265- Indonesia</span>
            <span>Telp. (031)5677796 / 5615592- Fax (031) 5684004</span>
            <span>E-mail: sekrupsby@sby.dnet.net.id</span>
        </div>
        <div class="d-flex align-items-center justify-content-center">
            <img src="/assets/img/logo-ks.png" width="50%" alt="kop-surat">
        </div>
        <div class="d-flex flex-column" style="text-align: end;">
            <span>CATHOLIC CHURCH</span>
            <span>DIOCESE OF SURABAYA</span>
            <span>17 Polisi Istimewa Str., Surabaya 60265 - Indonesia</span>
            <span>Phone +62.31.5677796 / 5615592- Fax +62.31.5684004</span>
            <span>E-mail: sekrupsby@sby.dnet.net.id</span>
        </div>
    </div>
    <hr style="background-color : black; height: 3px;">
</template>

<template name="arsipKorespondensi">
    <div class="arsip-container">
        <h1 class="arsip-heading">Arsip Surat Korespondensi</h1>
        <form class="upload-form">
          <div class="upload-section">
            {{> inputMultipleFilesSurat label="Pilih File Surat" id="buktiSurat" files=buktiSurat buttonLabel="Upload"}}
            <div class="form-actions">
                <button class="btn btn-primary" id="btn-save">Simpan</button>
            </div>
          </div>
        </form>
    </div>
    <br>
    <div name="listArsipKorespondensi">
        <label style="color: red;font-style: italic;">Catatan: Bila file PDF tidak terdapat review dalam jangka waktu lama , silahkan reload halaman ini</label>
        {{#each arsipFile}}
            <h2>{{name}}</h2>
            <iframe id="previewDoc" style="width: 100%; height: 300px;"
            src="https://docs.google.com/viewer?url={{link}}&embedded=true"></iframe>
        {{/each}}
    </div>
    <style>
        /* Stylesheet untuk tampilan arsipKorespondensi */
        .arsip-container {
            max-width: 100%;
            margin: 0 auto;
            padding: 20px;
            background-color: #f7f7f7;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .arsip-heading {
            font-size: 24px;
            margin-bottom: 20px;
            text-align: center;
        }

        .upload-form {
            display: flex;
            flex-direction: column;
        }

        .upload-section {
            margin-bottom: 20px;
        }

        .form-actions {
            margin-top: auto; /* Mendorong elemen ke bawah */
            display: flex;
            justify-content: flex-end; /* Mengatur tombol ke pojok kanan */
        }

        .btn-save {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .btn-save:hover {
            background-color: #0056b3;
        }


    </style>
</template>  


<template name="timelineWorkProgram">
    <div class="box">
      <ul id="first-list">
        {{ #each timeline }}
        <li>
          <span></span>
          <div class="title">{{ event }}</div>
          <div class="name">{{ operatorName }}</div>
          <div class="info">{{ formatHRDT timestamp }}</div>
  
          <div class="time">
            <span>{{ formatD timestamp }}</span>
            <span>{{ formatH timestamp }}</span>
          </div>
        </li>
        {{ /each }}
      </ul>
    </div>
  
    <style>
      .box {
        background-color: darkgray;
        /* margin:0 10%; */
        overflow: hidden;
        padding: 10px 0 40px 60px;
        border-radius: 1%;
      }
  
      .box ul {
        list-style-type: none;
        margin: 0;
        padding: 0;
        position: relative;
        transition: all 0.5s linear;
        top: 0;
      }
  
      /* .box ul:last-of-type{top:80px} */
  
      .box ul:before {
        content: "";
        display: block;
        width: 0;
        height: 100%;
        border: 1px dashed #000000;
        position: absolute;
        top: 0;
        left: 30px
      }
  
      .box ul li {
        margin: 20px 60px 60px;
        position: relative;
        padding: 10px 20px;
        background: rgba(255, 255, 255, 0.3);
        color: #000000;
        border-radius: 10px;
        line-height: 20px;
        width: 50%
      }
  
  
      .box ul li>span {
        content: "";
        display: block;
        width: 0;
        height: 100%;
        border: 1px solid #000000;
        position: absolute;
        top: 0;
        left: -30px
      }
  
      .box ul li>span:before,
      .box ul li>span:after {
        content: "";
        display: block;
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background: #ffffff;
        border: 2px solid #000000;
        position: absolute;
        left: -7.5px
      }
  
      .box ul li>span:before {
        top: -10px
      }
  
      .box ul li>span:after {
        top: 95%
      }
  
      .box .title {
        text-transform: uppercase;
        font-weight: 700;
        margin-bottom: 5px
      }
  
      .box .info:first-letter {
        text-transform: capitalize;
        line-height: 1.7
      }
  
      .box .name {
        margin-top: 10px;
        text-transform: capitalize;
        font-style: italic;
        margin-right: 20px
      }
  
  
      .box .time span {
        position: absolute;
        left: -100px;
        color: #000000;
        font-weight: bold;
      }
  
      .box .time span:first-child {
        top: -16px
      }
  
      .box .time span:last-child {
        top: 94%
      }
  
      svg {
        width: 20px;
        height: 20px
      }
  
      @keyframes arrow {
  
        0%,
        100% {
          top: 105%
        }
  
        50% {
          top: 106%
        }
      }
  
      @-webkit-keyframes arrow {
  
        0%,
        100% {
          top: 105%
        }
  
        50% {
          top: 106%
        }
      }
  
      @-moz-keyframes arrow {
  
        0%,
        100% {
          top: 105%
        }
  
        50% {
          top: 106%
        }
      }
  
      @-o-keyframes arrow {
  
        0%,
        100% {
          top: 105%
        }
  
        50% {
          top: 106%
        }
      }
    </style>
</template>

<template name="inputMultipleFilesSurat">
	<div class="form-group">
	  <label for="">{{label}}</label>
	  <div class="input-file-wrapper">
		<input type="file" id="{{id}}" class="{{id}} mt-3 hide hidden d-none" name="filename"
		  accept=".pdf, .doc, .docx" multiple>
		<label class="btn btn-primary"
		  for="{{ id }}">{{#if buttonLabel }}{{ buttonLabel}}{{else}}{{ label }}{{/if}}</label>
	  </div>
	  <div class="d-flex flex-row">
		{{#each file in files}}
            {{#if equals file.type 'image/png'}}
                <div class="uploaded-image mr-2">
                <img src="{{file.src}}">
                <button class="btn btn-danger remove-image remove-{{id}}" milik="{{@index}}">
                    <i class="fa fa-trash" milik="{{@index}}"></i>
                </button>
                </div>
            {{else}}
                <div class="uploaded-image mr-2">
                <a download id="{{id}}-{{@index}}" href="{{file.src}}" target="_blank">
                    <i class="fa fa-file"></i>
                    <p class="file-name">{{file.file.name}}</p>
                </a>
                <button class="btn btn-danger remove-image remove-{{id}}" milik="{{@index}}">
                    <i class="fa fa-trash" milik="{{@index}}"></i>
                </button>
                </div>
            {{/if}}
		{{/each}}
	  </div>
	</div>
</template>