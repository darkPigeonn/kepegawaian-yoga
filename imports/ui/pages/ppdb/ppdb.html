<template name="pagePpdb">
  <div class="container">
    <div class="page-title mt-2">
      <h3>Daftar Calon Siswa Baru</h3>
    </div>
    <div class="page-content mt-3">
      <table class="table table-group-divider">
        <thead>
          <th>No.</th>
          <th>Nama</th>
          <th>Tanggal Lahir | Umur</th>
          <th>Tanggal Daftar</th>
          <th>Status</th>
          <th>Aksi</th>
        </thead>
        <tbody>
          {{#each students}}
          <tr>
            <td>
              {{getNumber @index}}
            </td>
            <td>
              {{capitalizeWord fullName}} <br>
              <span class="span-nis">{{#if notEquals nis "-"}}{{nis}} {{else}} NIS Tidak diisi {{/if}}</span>
            </td>
            <td>
              {{formatHRDate2 dob}} <br> {{thisAge dob}}
            </td>
            <td>
              {{formatHRDate createdAt}}
            </td>
            <td>
              {{statusPpdb status}}
            </td>
            <td>
              <a href="/ppdb/details/{{toMeteorId _id}}" class="btn btn-primary" id="btn-detail">Lihat</a>
            </td>
          </tr>
          {{/each}}
        </tbody>
      </table>
      <nav>
        <ul class="pagination">
          {{#each getPageNumbers totalPages}}
          <li class="{{isActive this}}"><a href="#" class="page-link" data-page="{{this}}">{{this}}</a></li>
          {{/each}}
        </ul>
      </nav>
    </div>
  </div>
</template>

<template name="periodPpdb">
  <div class="container">

  </div>
</template>


<!-- Virtual Account  -->
<template name="pageVa">
  <div class="container">
    <div class="page-title">
      <h3>Daftar Virtual Account</h3>
    </div>
    <div class="page-action">
      <div class="float-right my-3">
        <a href="/ppdb/va/generate" class="btn btn-primary" id="btn-generate-va">Generate VA</a>
        <button class="btn btn-primary" id="btn-open-form-download">Unduh Va</button>

        <button class="btn btn-primary" id="btn-va-aktif">Aktifkan VA</button>
      </div>
    </div>
    <div class="page-content mt-3">
      {{#if formUnduh}}
      <div class="p-5">
        {{> formUnduhVa idButton='btn-download' label="Unduh VA"}}
      </div>
      {{/if}}
      {{#if formAktif}}
      <div class="p-5">
        {{> formUnduhVa idButton='btn-aktif-va' label='Aktifkan VA'}}
      </div>
      {{/if}}
      <div>
        <div class="form-group">
          <select class="form-control selected-category">
            <option value="all">Semua Kategori</option>
            <option value="08">Formulir</option>
            <option value="90">Pembayaran Lunas</option>
            <option value="99">Pembayaran Cicil</option>
          </select>
        </div>
      </div>
      <table class="table tabl">
        <thead>
          <th>No.</th>
          <th>Nomor VA</th>
          <th>Nama Sekolah</th>
          <th>Nominal</th>
          <th>Tanggal dibuat</th>
          <th>Status</th>
          <th>Kategori</th>
          <!-- <th>Aksi</th> -->
        </thead>
        <tbody>
          {{#each va}}
          <tr>
            <td>
              {{getNumber @index}}
            </td>
            <td>
              {{virtualAccountNumber}}
            </td>
            <td>
              {{schoolName}} | {{unitName}}
            </td>
            <td>
              {{formatRp amount}}
            </td>
            <td>
              {{formatHRDate createdAt}}
            </td>

            <td>
              {{statusVa status}}
            </td>
            <td>
              {{categoryVa category}}
            </td>
            <!-- <td>
              <button class="btn btn-primary" id="btn-update">Kelola</button>
            </td> -->
          </tr>
          {{/each}}
        </tbody>
      </table>
      <nav>
        <ul class="pagination">

          {{#each getPageNumbers totalPages}}
          <li class="{{isActive this}}"><a href="#" class="page-link" data-page="{{this}}">{{this}}</a></li>
          {{/each}}
        </ul>
      </nav>
    </div>
  </div>


</template>

<template name="pageGenerateVa">
  <div class="container">
    <div class="page-title my-2">
      <h3>Generate Virtual Account</h3>
    </div>

    <div class="page-content">
      <div class="form-group">
        <label>Pilih Perwakilan</label>
        <select class="form-control select2" id="select-perwakilan">
          <option value="0">-- Silahkan Pilih Perwakilan --</option>

        </select>
      </div>
      <div class="form-group" id="section-school-select">
        <label>Pilih Sekolah</label>
        <select class="form-control select2 " id="select-school" multiple disabled>
          <option value="0">-- Silahkan Pilih Sekolah --</option>
          {{#each listSchools}}
          <option value="{{_id}}">{{name}} - {{city}}</option>
          {{/each}}
        </select>
      </div>
      <div class="form-group">
        <label>Input Kode Tahun Ajaran</label>
        <select id="selectedPeriode" class="form-control">
          <option value="0">-- Silahkkan Pilih --</option>
          {{#each listPeriode}}
          <option value="{{_id}}">{{year}}</option>
          {{/each}}
        </select>
        <!-- <input id="input-kode-periode" type="number" class="form-control" /> -->
      </div>
      <div class="form-group">
        <label>Pilih Tag</label>
        <select class="form-control" id="select-tag">
          <option value="0">-- Silahkan Pilih Tag --</option>
          <option value="formulir">Formulir (08)</option>
          <option value="spp">Uang Sekolah Full (90)</option>
          <option value="sppCicil">Uang Sekolah Cicil (99)</option>
        </select>
      </div>
      <button class="btn btn-primary btn-block" id="btn-generate" disabled>Generate</button>
    </div>

    <div class="preview-va">

      <table class="table table-bordered">
        <thead>
          <th>No.</th>
          <th>Sekolah</th>
          <th>Perwakilan</th>
          <th>Nomor VA</th>
        </thead>
        <tbody>
          {{#each listVa}}
          <tr>
            <td>
              {{getNumber @index}}
            </td>
            <td>
              {{schoolName}}
            </td>
            <td>
              {{unitName}}
            </td>
            <td>
              {{va}}
            </td>
            <td>

            </td>
          </tr>
          {{/each}}
        </tbody>
      </table>

    </div>

    <nav>
      <ul class="pagination">
        {{#each getPageNumbers totalPages}}
        <li class="{{isActive this}}"><a href="#" class="page-link" data-page="{{this}}">{{this}}</a></li>
        {{/each}}
      </ul>
    </nav>
    <button class="btn btn-primary btn-block" id="btn-save">Simpan</button>

    <!-- <div>
      <button class="prev" {{prevDisabled}}>Sebelumnya</button>
      <button class="next" {{nextDisabled}}>Selanjutnya</button>
    </div>
    <div>
      <label for="page-select">Page:</label>
      <select class="page-select">
        {{#each pageNumbers}}
        <option value="{{this}}" {{isCurrentPage}}>{{this}}</option>
        {{/each}}
      </select>
    </div> -->
  </div>

</template>


<!-- PAYMENT -->
<template name="paymentPage">
  <div class="container my-2">
    <div class="page-title my-2">
      <h3>Konfirmasi Pembayaran</h3>
    </div>
    <div class="page-content">
      <div class="section-action d-flex justify-content-between">
        <input type="file" accept=".xlsx" id="upload-csv" />
        <a href="https://static.imavi.org/yayoga/format_konfirmasi_va.xlsx">Unduh Format Konfirmasi VA XLSX</a>
      </div>
      <div class="section-data">
        <table class="table table-borderless">
          <thead>
            <th>No</th>
            <th>Kode Perusahaan</th>
            <th>No. Pelanggan</th>
            <th>No. VA</th>
            <th>Nama Pelanggan</th>
            <th>Nilai Transaksi</th>
            <th>Tanggal Transaksi</th>
            <th>Berita</th>
          </thead>
          <tbody>
            {{#each listPaymentVa}}
            <tr>
              <td>{{nomorUrut @index}}</td>
              <td>{{compCode}}</td>
              <td>{{numberCustomer}}</td>
              <td>{{va}}</td>
              <td>{{name}}</td>
              <td>{{formatRp amount}}</td>
              <td>{{formatHRDateShort date}} {{formatTime time}}</td>
              <td>{{note}}</td>
            </tr>
            {{/each}}
          </tbody>
        </table>
      </div>

      <button class="btn btn-primary btn-block" id="btn-save" disabled>Proses</button>
    </div>
  </div>
</template>
<template name="paymentFinalPage">
  <div class="container my-2">
    <div class="page-title my-4">
      <h3>Konfirmasi Pembayaran Uang Masuk</h3>
    </div>
    <div class="page-content">
      <div class="section-action d-flex justify-content-between">
        <input type="file" accept=".xlsx" id="upload-csv" />
        <a href="https://static.imavi.org/yayoga/format_konfirmasi_va.xlsx">Unduh Format Konfirmasi VA XLSX</a>
      </div>
      <div class="section-data">
        <table class="table table-borderless">
          <thead>
            <th>No</th>
            <th>Kode Perusahaan</th>
            <th>No. Pelanggan</th>
            <th>No. VA</th>
            <th>Nama Pelanggan</th>
            <th>Nilai Transaksi</th>
            <th>Tanggal Transaksi</th>
            <th>Berita</th>
          </thead>
          <tbody>
            {{#each listPaymentVa}}
            <tr>
              <td>{{nomorUrut @index}}</td>
              <td>{{compCode}}</td>
              <td>{{numberCustomer}}</td>
              <td>{{va}}</td>
              <td>{{name}}</td>
              <td>{{formatRp amount}}</td>
              <td>{{formatHRDateShort date}} {{formatTime time}}</td>
              <td>{{note}}</td>
            </tr>
            {{/each}}
          </tbody>
        </table>
      </div>

      <button class="btn btn-primary btn-block" id="btn-save" disabled>Proses</button>
    </div>
  </div>

</template>


<!-- Registrans -->
<template name="detailRegistran">
  <div class="container mt-5">
    <div class="page-title">
      <h3>Detail Pendaftar</h3>
    </div>

    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/">Beranda</a></li>
        <li class="breadcrumb-item"><a href="/ppdb">Daftar PPDB</a></li>
        <li class="breadcrumb-item active" aria-current="page">{{registran.fullName}}</li>
      </ol>
    </nav>
    <div class="page-content">
      <div class="card">
        {{> alertDiv status=registran.status}}
       <div class="row">
          <div class="col-4">
            <div class="img-rounded ml-2">
              {{#if photoStudent.uploaded}}
              {{> fancyBox url=photoStudent.uploaded class='img-thumbnail'}}
              {{else}}
              <img src="/assets/img/dimage.jpg" class="img-thumbnail" />
              {{/if}}
            </div>
          </div>

          <div class="col-8">
            <table class="table">
              <tr>
                <th>Nama </th>
                <td>{{capitalizeWord registran.fullName}}</td>
              </tr>
              <tr>
                <th>Tanggal Lahir</th>
                <td>{{formatHRDate2 registran.dob}}</td>
              </tr>
              <tr>
                <th>Umur</th>
                <td>{{thisAge registran.dob}}</td>
              </tr>
              <tr>
                <th>Gelombang</th>
                <td>{{registran.gelombang}}</td>
              </tr>
              <tr>
                <th>Tahun Ajaran</th>
                <td>{{registran.periodName}}</td>
              </tr>
              <tr>
                <th>Kelas</th>
                <td>{{registran.destinationClass}}</td>
              </tr>
              <tr>
                <th>Nomor VA</th>
                <td>{{registran.noVA}}</td>
              </tr>
              <tr>
                {{#if betweenEquals registran.status 40 60}}
                <th>Metode Pembayaran Uang Masuk</th>
                <td>{{registran.paymentMethod}}</td>
                {{#if equals registran.paymentMethod 'Kontan'}}

                {{else}}
                <td><a href="/ppdb/details/{{toMeteorId registran._id}}/setCicil" class="btn btn-warning">Buat
                    Konfigurasi
                    Cicilan</a></td>
                {{/if}}
                {{/if}}
              </tr>
            </table>
            {{#if greaterThan registran.status 34}}
            <button class="btn btn-primary btn-block btn-create-schedule">Buat Jadwal Wawancara</button>
              {{/if}}
          </div>
        </div>
      </div>
      <!-- ini kalau sudah ngisi form lengkap  -->
      {{#if registran.initialPaymentStatus}}
      <div class="card">
        <div class="card-header">
          Data Orang Tua
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-6">
              <div class="card-title">
                Data Ayah
              </div>
              <table class="table table-bordered">
                <tr>
                  <td>Nama</td>
                  <td>{{capitalizeWord registran.father.fullName}}</td>
                </tr>
                <tr>
                  <td>Tanggal Lahir</td>
                  <td>{{formatHRDate registran.father.dob}}</td>
                </tr>
                <tr>
                  <td>Alamat</td>
                  <td>{{registran.father.address}}</td>
                </tr>
                <tr>
                  <td>Agama</td>
                  <td>{{registran.father.religion}}</td>
                </tr>
                <tr>
                  <td>Kewarganegaraan</td>
                  <td>{{registran.father.nationality}}</td>
                </tr>
                <tr>
                  <td>Pendidikan Terakhir</td>
                  <td>{{registran.father.lastEducation}}</td>
                </tr>
                <tr>
                  <td>Pekerjaan</td>
                  <td>{{registran.father.occupation}}</td>
                </tr>
                <tr>
                  <td>Pendapatan Bulanan</td>
                  <td>{{formatRp registran.father.incomePerMonth}}</td>
                </tr>
                <tr>
                  <td>Status</td>
                  <td>{{registran.father.status}}</td>
                </tr>
              </table>
            </div>
            <div class="col-6">
              <div class="card-title">
                Data Ibu
              </div>
              <table class="table table-bordered">
                <tr>
                  <td>Nama</td>
                  <td>{{capitalizeWord registran.mother.fullName}}</td>
                </tr>
                <tr>
                  <td>Tanggal Lahir</td>
                  <td>{{formatHRDate registran.mother.dob}}</td>
                </tr>
                <tr>
                  <td>Alamat</td>
                  <td>{{registran.mother.address}}</td>
                </tr>
                <tr>
                  <td>Agama</td>
                  <td>{{registran.mother.religion}}</td>
                </tr>
                <tr>
                  <td>Kewarganegaraan</td>
                  <td>{{registran.mother.nationality}}</td>
                </tr>
                <tr>
                  <td>Pendidikan Terakhir</td>
                  <td>{{registran.mother.lastEducation}}</td>
                </tr>
                <tr>
                  <td>Pekerjaan</td>
                  <td>{{registran.mother.occupation}}</td>
                </tr>
                <tr>
                  <td>Pendapatan Bulanan</td>
                  <td>{{formatRp registran.mother.incomePerMonth}}</td>
                </tr>
                <tr>
                  <td>Status</td>
                  <td>{{registran.mother.status}}</td>
                </tr>
              </table>
            </div>
            <div class="col-6">
              <div class="card-title">
                Data Wali
              </div>
              <table class="table table-bordered">
                <tr>
                  <td>Nama</td>
                  <td>{{capitalizeWord registran.wali.fullName}}</td>
                </tr>
                <tr>
                  <td>Tanggal Lahir</td>
                  <td>{{formatHRDate registran.wali.dob}}</td>
                </tr>
                <tr>
                  <td>Alamat</td>
                  <td>{{registran.wali.address}}</td>
                </tr>
                <tr>
                  <td>Agama</td>
                  <td>{{registran.wali.religion}}</td>
                </tr>
                <tr>
                  <td>Kewarganegaraan</td>
                  <td>{{registran.wali.nationality}}</td>
                </tr>
                <tr>
                  <td>Pendidikan Terakhir</td>
                  <td>{{registran.wali.lastEducation}}</td>
                </tr>
                <tr>
                  <td>Pekerjaan</td>
                  <td>{{registran.wali.occupation}}</td>
                </tr>
                <tr>
                  <td>Pendapatan Bulanan</td>
                  <td>{{formatRp registran.wali.incomePerMonth}}</td>
                </tr>
                <tr>
                  <td>Status</td>
                  <td>{{registran.wali.status}}</td>
                </tr>
              </table>
            </div>
          </div>

        </div>
      </div>
      <div class="card">
        <div class="card-header">
          Data Unggahan
        </div>
        <div class="card-body">
          <table class="table">
            <thead>
              <th>Nama Unggahan</th>
              <th>Detail Unggahan</th>
            </thead>
            <tbody>
              {{#each registran.links}}
              <tr>
                <td>
                  {{nama}}
                </td>
                <td>
                  {{#if uploaded}}
                  {{> fancyBox url=uploaded class='img-preview'}}
                  {{else}}
                  Tidak ada unggahan
                  {{/if}}
                </td>
              </tr>
              {{/each}}
            </tbody>
          </table>
        </div>
      </div>
      {{#if lessThan registran.status 40}}
      <button class="btn btn-primary btn-block btn-accepted" milik="{{toMeteorId registran._id}}">Terima</button>
      <button class="btn btn-danger btn-block btn-rejected" milik="{{toMeteorId registran._id}}">Tolak</button>
      {{/if}}
      {{/if}}
    </div>

    {{> c_modal title='Buat Jadwal Wawancara' idModal="addSchedule" bodyTemplate="formInputSchedule" bodyData=yourFormData formId="setScheduleForm"}}

  </div>
</template>
<template name="cicilanRegistran">
  <div class="container mt-5">
    <div class="page-title">
      <h3>Detail Cicilan Pendaftar</h3>
    </div>
    <div class="page-content">
      <div class="card">
        <div class="m-2">
          <button class="btn btn-warning float-right" id="lockCicilan">Kunci Cicilan</button>
          <button class="btn btn-primary float-right" id="addCicilan"> {{#if formCicilan}}Tutup{{else}}+
            Cicilan{{/if}}</button>
        </div>
        {{#if formCicilan}}
        <div class="row m-3">
          <div class="col-12">
            <div class="form-group">
              <label>Cicilan ke : </label>
              <input class="form-control" id="input-index" type="number" />
            </div>
          </div>
          <div class="col-3">
            <label>Uang SPP</label>
            <input class="form-control inputNominal" id="input-spp" />
          </div>
          <div class="col-3">
            <label>Uang Sumbangan</label>
            <input class="form-control inputNominal" id="input-donation" />
          </div>
          <div class="col-3">
            <label>Uang Kegiatan</label>
            <input class="form-control inputNominal" id="input-event" />
          </div>
          <div class="col-3">
            <label>Uang Alat</label>
            <input class="form-control inputNominal" id="input-utility" />
          </div>
          <button class="btn btn-primary btn-block mt-3" id="btn-save-cicilan">Simpan</button>
          <hr>
        </div>
        {{/if}}
        <div class="row">
          <div class="col-4">
            <div class="img-rounded ml-2">
              {{#if equals photoStudent '-'}}
              <img src="/assets/img/dimage.jpg" class="img-thumbnail" />
              {{else}}

              <img src="{{photoStudent.uploaded}}" class="img-thumbnail" />
              {{/if}}
            </div>
          </div>

          <div class="col-8">

            <table class="table">
              <tr>
                <th>Nama </th>
                <td>{{capitalizeWord registran.fullName}}</td>
              </tr>
              <tr>
                <th>Tanggal Lahir</th>
                <td>{{formatHRDate2 registran.dob}}</td>
              </tr>
              <tr>
                <th>Umur</th>
                <td>{{thisAge registran.dob}}</td>
              </tr>
              <tr>
                <th>Gelombang</th>
                <td>{{registran.gelombang}}</td>
              </tr>
              <tr>
                <th>Tahun Ajaran</th>
                <td>{{registran.periodName}}</td>
              </tr>
              <tr>
                <th>Kelas</th>
                <td>{{registran.destinationClass}}</td>
              </tr>
              <tr>
                <th>Metode Pembayaran Uang Masuk</th>
                <td>{{registran.paymentMethod}}</td>
              </tr>
            </table>
          </div>

          <!-- list credit  -->
          <div class="col-12">
            <table class="table table-bordered">
              <thead>
                <th>Nomor</th>
                <th>Cicilan Ke :</th>
                <th>SPP</th>
                <th>SUMBANGAN</th>
                <th>KEGIATAN</th>
                <th>ALAT</th>
                <th>Status</th>
              </thead>
              <tbody>
                {{#each registran.listCredits}}
                <tr>
                  <td>{{nomorUrut @index}}</td>
                  <td>{{index}}</td>
                  <td>{{formatRp feeSpp}}</td>
                  <td>{{formatRp feeDonation}}</td>
                  <td>{{formatRp feeEvent}}</td>
                  <td>{{formatRp feeUtility}}</td>
                  <td>{{statusCredit status}}</td>
                </tr>
                {{/each}}
              </tbody>
            </table>
          </div>
        </div>
      </div>

    </div>
  </div>
</template>