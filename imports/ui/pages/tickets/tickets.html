<template name="listTicket">
    <div class="container">
        <div class="mt-5">
            <div class="d-flex justify-content-end mb-2">
                <a href="/tickets/create" class="btn btn-primary">+ Tambah</a>
            </div>
        </div>
        <div class="d-lg-block table-responsive">
            <table class="table">
                <thead>
                    <tr>
                        <th scope="col">No</th>
                        <th scope="col">Judul</th>
                        <th scope="col">Prioritas</th>
                        <th scope="col">Status</th>
                        <th scope="col">Pembuat</th>
                        <th scope="col">Tanggal Dibuat</th>
                        <th scope="col">Action</th>
                    </tr>
                </thead>
                <tbody>
                    {{#each dataTicket}}
                        <tr>
                            <td> {{nomorUrut @index}}</td>
                            <td> {{title}} </td>
                            <td> {{priority}} </td>
                            <td> {{status}} </td>
                            <td> {{createdByName}} </td>
                            <td> {{formatHRDate createdAt}}</td>
                            <td>
                                {{#if equals isOwned 1}}
                                    <a href="/employees/edit/{{_id}}">
                                        <button class="btn btn-primary" type="button" id="btn_edit">Edit</button>
                                    </a>
                                    <a href="/employees/detail/{{_id}}">
                                        <button class="btn btn-secondary" type="button" id="btn_details">Details</button>
                                    </a>
                                {{else}}
                                    <a href="/employees/detail/{{_id}}">
                                        <button class="btn btn-secondary" type="button" id="btn_details">Details</button>
                                    </a>
                                {{/if}}
                                
                            </td>
                        </tr>
                    {{/each}}
                </tbody>
            </table>
        </div>
    </div>
</template>

<template name="createTicket">
    <div class="container">
        <div class="section-title-page">
            <h3>Buat Tiket Baru</h3>
        </div>
        <div class="section-content-page">
            <div class="page">
                <div class="form-group">
                    <label for="">Judul</label>
                    <input type="text" id="title" class="form-control">
                </div>
                <div class="form-group">
                    <label for="">Deskripsi</label>
                    <input type="text" id="description" class="form-control">
                </div>
                <div class="form-group mb-3">
                    <label class="fw-bold">Tingkat Prioritas</label>
                    <div class="d-flex gap-2">
                        <div>
                            <input type="radio" name="select-priority" value="high" id="select-priority">
                            <b class="fw-bold" style="color: #ff6363;">High</b>
                        </div>
                        <div>
                            <input type="radio" name="select-priority" value="mid" id="select-priority">
                            <b class="fw-bold" style="color: #ffac74;">Mid</b>
                        </div>
                        <div>
                            <input type="radio" name="select-priority" value="low" id="select-priority">
                            <b class="fw-bold" style="color: #6adc6a;">Low</b>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    {{> inputMultipleFiles label="Bukti" id="buktiTiket" files=buktiTiket buttonLabel="Upload"}}
                </div>
        
                <div class="form-group">
                    <label>Daftar Pekerja</label>
                    <select id="input_workers" class="form-control select2" multiple>
                        {{#each workers}}
                            <option value="{{_id}}">{{ full_name }}</option>
                        {{/each}}
                    </select>
                    <br><br>
                    <button class="btn btn-primary" id="btn-add-workers">Tambah</button>
                </div>
                {{#if daftarWorker}}
                    <h4>Daftar Pekerja</h4>
                    <div class="table-responsive">
                        <table class="table table-bordered">
                            <thead>
                                <th>Nomor</th>
                                <th>Nama</th>
                                <th>Action</th>
                            </thead>
                            <tbody>
                                {{#each i in daftarWorker}}
                                <tr>
                                    <td>
                                        {{setTableNumber @index}}
                                    </td>
                                    <td>
                                        {{i.workerName}}
                                    </td>
                                    <td>
                                        <button class="btn btn-danger btn-remove" posisi={{@index}}>
                                            <i class="fa fa-trash" posisi={{@index}}></i>
                                        </button>
                                    </td>
                                </tr>
                                {{/each}}
                            </tbody>
                        </table>
                    </div>
                {{/if}}
        
                <div class="form-actions">
                    <button class="btn btn-primary" id="btn-save">Simpan</button>
                </div>
            </div>
        </div>
    </div>
</template>

<template name="editTicket">

</template>

<!-- Template Upload File -->
<template name="inputMultipleFiles">
	<div class="form-group">
	  <label for="">{{label}}</label>
	  <div class="input-file-wrapper">
		<input type="file" id="{{id}}" class="{{id}} mt-3 hide hidden d-none" name="filename"
		  accept=".png, .jpg, .jpeg" multiple>
		<label class="btn btn-primary"
		  for="{{ id }}">{{#if buttonLabel }}{{ buttonLabel}}{{else}}{{ label }}{{/if}}</label>
	  </div>
	  <div class="d-flex flex-row">
		{{#each file in files}}
            {{#if equals file.type 'image/png'}}
                <div class="uploaded-image mr-2">
                <img src="{{file.src}}">
                <button class="btn btn-danger remove-image remove-{{id}}" milik="{{@index}}">
                    <i class="fa fa-trash" milik="{{@index}}"></i>
                </button>
                </div>
            {{else}}
                <div class="uploaded-image mr-2">
                <a download id="{{id}}-{{@index}}" href="{{file.src}}" target="_blank">
                    <i class="fa fa-file"></i>
                    <p class="file-name">{{file.file.name}}</p>
                </a>
                <button class="btn btn-danger remove-image remove-{{id}}" milik="{{@index}}">
                    <i class="fa fa-trash" milik="{{@index}}"></i>
                </button>
                </div>
            {{/if}}
		{{/each}}
	  </div>
	</div>
</template>